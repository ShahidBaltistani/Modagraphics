<!DOCTYPE html>

<html lang="en">
<head>

    <style>
        .disable-button {
            pointer-events: none !important;
            cursor: not-allowed !important;
            opacity: 0.7 !important;
        }
    </style>

    <meta charset="utf-8" />
    <title>
        Rapidus
    </title>
    <meta name="description" content="Latest updates and statistic charts">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no">
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js"></script>
    <script>
        WebFont.load({
            google: { "families": ["Poppins:300,400,500,600,700", "Roboto:300,400,500,600,700", "Asap+Condensed:500"] },
            active: function () {
                sessionStorage.fonts = true;
            }
        });
    </script>

    <link href="~/Theme/css/vendors.bundle.css" rel="stylesheet" type="text/css" />
    <link href="~/Theme/css/style.bundle.css" rel="stylesheet" type="text/css" />
    <link href="~/Theme/css/custom.css" rel="stylesheet" />
    <link rel="shortcut icon" href="~/Theme/img/logo/fav-icon.ico" />

    <script src="~/Theme/js/vendors.bundle.js"></script>
    <script src="~/Theme/js/scripts.bundle.js"></script>
    <script src="~/Theme/js/bootstrap-select.js"></script>
    <script src="~/Theme/js/bootstrap-datepicker.js"></script>
    <script src="~/Theme/js/custom.js"></script>

    <script src="~/Theme/js/angular.min.js"></script>
    <script src="~/Theme/js/angular-route.min.js"></script>
    <script src="~/Theme/js/angular-ui/ui-bootstrap-tpls.js"></script>
    <script src="~/Theme/js/image-compressor.js"></script>
    <script src="~/Angular/app.js"></script>
    <script src="~/Angular/com.js"></script>
    @RenderSection("controller", false)


</head>

<body ng-app="app" style="background-color: rgb(251, 223, 182);" class="m-page--fluid m-page--loading-enabled m-page--loading m-header--fixed m-header--fixed-mobile m-footer--push m-aside--offcanvas-default">
    <!-- begin::Page loader -->
    <div class="m-page-loader m-page-loader--base">
        <div class="m-blockui">
            <span>
                Please wait...
            </span>
            <span>
                <span class="m-loader m-loader--brand"></span>
            </span>
        </div>
    </div>
    <!-- end::Page Loader -->
    <!-- begin:: Page -->
    <div class="m-grid m-grid--hor m-grid--root m-page">
        <!-- begin::Header -->
        <header id="m_header" class="m-grid__item		m-header " m-minimize="minimize" m-minimize-mobile="minimize" m-minimize-offset="10" m-minimize-mobile-offset="10">
            <div class="m-header__top">
                <div class="m-container m-container--fluid m-container--full-height m-page__container">
                    <div class="m-stack m-stack--ver m-stack--desktop">
                        <!-- begin::Brand -->
                        <div class="m-stack__item m-brand m-stack__item--left">
                            <div class="m-stack m-stack--ver m-stack--general m-stack--inline">
                                <div class="m-stack__item m-stack__item--middle m-brand__logo">
                                    <a class="m-brand__logo-wrapper">
                                        <img alt="" src="~/Theme/img/logo/rapidus-logo-white.png" class="m-brand__logo-default" />
                                        <img alt="" src="~/Theme/img/logo/rapidus-logo-white.png" class="m-brand__logo-inverse" />
                                    </a>
                                </div>
                                <div class="m-stack__item m-stack__item--middle m-brand__tools">
                                    <!-- begin::Responsive Header Menu Toggler-->
                                    <a id="m_aside_header_menu_mobile_toggle" href="#" class="m-brand__icon m-brand__toggler m--visible-tablet-and-mobile-inline-block">
                                        <span></span>
                                    </a>
                                    <!-- end::Responsive Header Menu Toggler-->
                                    <!-- begin::Topbar Toggler-->
                                    <a id="m_aside_header_topbar_mobile_toggle" href="#" class="m-brand__icon  m--visible-tablet-and-mobile-inline-block">
                                        <i class="flaticon-more" style="right:8px;"></i>
                                    </a>
                                    <!--end::Topbar Toggler-->
                                </div>
                            </div>
                        </div>
                        <!-- end::Brand -->
                        <!-- begin::Topbar -->
                        <div class="m-stack__item m-stack__item--right m-header-head" id="m_header_nav">
                            <div id="m_header_topbar" class="m-topbar  m-stack m-stack--ver m-stack--general">
                                <div class="m-stack__item m-topbar__nav-wrapper">
                                    <ul class="m-topbar__nav m-nav m-nav--inline">
                                        <li class="m-nav__item m-topbar__user-profile  m-dropdown m-dropdown--medium m-dropdown--arrow  m-dropdown--align-right m-dropdown--mobile-full-width m-dropdown--skin-light" m-dropdown-toggle="click">
                                            <a href="#" class="m-nav__link m-dropdown__toggle" style=" z-index: 10;">
                                                <span class="m-topbar__userpic">
                                                    <img src="@ViewBag.Image" alt="No Image"
                                                         class="m--img-rounded m--marginless m--img-centered" />
                                                </span>
                                                <span class="m-nav__link-icon m-topbar__usericon  m--hide">
                                                    <span class="m-nav__link-icon-wrapper">
                                                        <i class="flaticon-user-ok"></i>
                                                    </span>
                                                </span>
                                                <span class="m-topbar__username m--hide">
                                                    Nick
                                                </span>
                                            </a>
                                            <div class="m-dropdown__wrapper">
                                                <span class="m-dropdown__arrow m-dropdown__arrow--right m-dropdown__arrow--adjust"></span>
                                                <div class="m-dropdown__inner">
                                                    <div class="m-dropdown__header m--align-center">
                                                        <div class="m-card-user m-card-user--skin-light">
                                                            <div class="m-card-user__pic">
                                                                <img src="@ViewBag.Image" alt="No Image" class="m--img-rounded m--marginless" alt="" />
                                                            </div>
                                                            <div class="m-card-user__details">
                                                                <span class="m-card-user__name m--font-weight-500" style="font-weight:bold">
                                                                    @((string)ViewBag.Role.ToString())
                                                                </span>
                                                                    <span class="m-card-user__name m--font-weight-300">
                                                                        @ViewBag.Name
                                                                    </span>
                                                                    <a href="" class="m-card-user__email m--font-weight-300 m-link">
                                                                        @ViewBag.Email
                                                                    </a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="p-2 pl-3">
                                                        <div class="m-dropdown__content">
                                                            <ul class="m-nav m-nav--skin-light">
                                                                <li class="m-nav__item">
                                                                    <button class="btn btn-success" data-toggle="modal" data-target="#passowrd-modal">
                                                                        Change Password
                                                                    </button>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                    <div class="m-dropdown__body">
                                                        <div class="m-dropdown__content">
                                                            <ul class="m-nav m-nav--skin-light">
                                                                <li class="m-nav__item">
                                                                    <a href="/Login/Off" class="btn m-btn--pill    btn-secondary m-btn m-btn--custom m-btn--label-brand m-btn--bolder">
                                                                        Logout
                                                                    </a>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!-- end::Topbar -->
                    </div>
                </div>
            </div>
            <div class="m-header__bottom">
                <div class="m-container m-container--fluid m-container--full-height m-page__container">
                    <div class="m-stack m-stack--ver m-stack--desktop">
                        <!-- begin::Horizontal Menu -->
                        <div class="m-stack__item m-stack__item--fluid m-header-menu-wrapper">
                            <button class="m-aside-header-menu-mobile-close  m-aside-header-menu-mobile-close--skin-light " id="m_aside_header_menu_mobile_close_btn">
                                <i class="la la-close"></i>
                            </button>
                            @Html.Partial("~/Views/Shared/_" + (string)ViewBag.Role.ToString() + "Menu.cshtml")
                        </div>
                        <!-- end::Horizontal Menu -->
                    </div>
                </div>
            </div>
        </header>
        <!-- end::Header -->
        <!-- begin::Body -->
        <div class="m-grid__item m-grid__item--fluid  m-grid m-grid--ver-desktop m-grid--desktop m-page__container m-body">
            <div class="m-grid__item m-grid__item--fluid m-wrapper">
                <div class="m-content">
                    @RenderBody()
                </div>
            </div>
        </div>
        <!-- end::Body -->
        <!-- begin::Footer -->
        <footer class="m-grid__item m-footer ">
            <div class="m-container m-container--fluid m-container--full-height m-page__container">
                <div class="m-footer__wrapper">
                    <div class="m-stack m-stack--flex-tablet-and-mobile m-stack--ver m-stack--desktop">
                        <div class="m-stack__item m-stack__item--left m-stack__item--middle m-stack__item--last">
                            <span class="m-footer__copyright">
                                2019 &copy; Rapidus
                                <a href="#">
                                    Modagrafics
                                </a>
                            </span>
                        </div>
                        <div class="m-stack__item m-stack__item--right m-stack__item--middle m-stack__item--first">
                            <ul class="m-footer__nav m-nav m-nav--inline m--pull-right">
                                <li class="m-nav__item">
                                    <a href="#" class="m-nav__link">
                                        <span class="m-nav__link-text">
                                            About
                                        </span>
                                    </a>
                                </li>
                                <li class="m-nav__item">
                                    <a href="#" class="m-nav__link">
                                        <span class="m-nav__link-text">
                                            Privacy
                                        </span>
                                    </a>
                                </li>
                                <li class="m-nav__item">
                                    <a href="#" class="m-nav__link">
                                        <span class="m-nav__link-text">
                                            T&C
                                        </span>
                                    </a>
                                </li>
                                
                                    <li class="m-nav__item">
                                        <a href="/HOME/FAQ" class="m-nav__link">
                                            <span class="m-nav__link-text">
                                                FAQ
                                            </span>
                                        </a>
                                    </li>
                                
                                </ul>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!-- end::Footer -->
    </div>
    <!-- end:: Page -->
    <!-- begin::Scroll Top -->
    <div id="m_scroll_top" class="m-scroll-top">
        <i class="la la-arrow-up"></i>
    </div>

    <div class="modal fade" id="timeout-modal" tabindex="-1" role="dialog" aria-hidden="true" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">
                        Your Session is About to Expire!
                    </h3>
                </div>
                <div class="modal-body">
                    Your session will be expired in <span id="seconds"></span> seconds.
                </div>
                <div class="modal-footer">
                    <a class="btn btn-outline-metal" href="/Login/Off">Logout</a>
                    <button class="btn btn-info" onclick="keepMeAlive()">Stay Connected!</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="passowrd-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header p-2 pl-3">
                    <h5 class="modal-title" id="exampleModalLongTitle">Change Password</h5>
                </div>
                <div class="modal-body">
                    <form id="chngPassword">
                        <div class="form-group">
                            <label class="mandatory">Current Password</label>
                            <input name="old" autocomplete="off" id="old" class="form-control" type="password" required />
                        </div>
                        <div class="form-group">
                            <label class="mandatory">New Password</label>
                            <input name="new" class="form-control" id="newPassword" type="password" required />
                        </div>
                        <div class="form-group">
                            <label class="mandatory">Confirm Password</label>
                            <input class="form-control" type="password" id="comfirmPassword" required />
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <div class="clearfix">
                        <div class="pull-right">
                            <button type="button" class="btn btn-default" data-toggle="modal" data-target="#passowrd-modal">Cancel</button>
                            <button type="button" onclick="ChangePassword()" class="btn btn-success">Submit</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>

        $("#passowrd-modal").on('shown.bs.modal', function () {
            $('#newPassword').val('');
            $('#comfirmPassword').val('');
            $('#old').val('');
        });

        function ChangePassword() {
            var newPassword = $('#newPassword').val();
            var comfirmPassword = $('#comfirmPassword').val();
            var oldPassword = $('#old').val();
            if ((newPassword != comfirmPassword)) {
                swal('Required', "Comfirm password doesn't match.", 'warning');
                return;
            }
            else if (newPassword == "" || comfirmPassword == "" || oldPassword == "") {
                 swal('Required', "Enter all mandatory fields.", 'warning');
                return;
            }
            mApp.blockPage({ message: "Changing Password..." });
            $.ajax({
                url: '/Dashboard/ChangePassword/',
                dataType: 'json',
                contentType: "application/x-www-form-urlencoded",
                type: "POST",
                async: false,
                data: $('#chngPassword').serializeArray(),
                success: function (data) {
                    $('#passowrd-modal').modal('hide');

                     $('#newPassword').val('');
                     $('#comfirmPassword').val('');
                     $('#old').val('');

                    swal("Success", "Password has been changed successfully.", "success")
                    mApp.unblockPage();
                },
                error: function (error) {
                    mApp.unblockPage();
                    var obj = error.responseJSON;
                    if (obj.Caption === 'Unauthorized') {
                        swal('Incorrect Password', 'The password you entered is incorrect', 'warning');
                    } else if (obj.Caption === 'Not Found') {
                        swal(obj.Caption, 'User not found in database', 'error');
                    } else {
                        swal(obj.Caption, obj.Message, "error");
                    }
                }
            });
        }

        $(window).on('load', function () {
            $('body').removeClass('m-page--loading');

            $('.m-menu__item--active-tab').removeClass('m-menu__item--active-tab');
            $('m-menu__item--active').removeClass('m-menu__item--active');

            $('#@ViewBag.MainMenu').addClass('m-menu__item--active-tab');
            $('#@ViewBag.MainMenu').addClass('m-menu__item--active');
            var subMenu = '@ViewBag.SubMenu';
            if(subMenu !== '')
                $('#' + subMenu).addClass('m-menu__item--active');
        });
    </script>

</body>
</html>
